{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Overview","text":"Work with PT Sandbox like a pro"},{"location":"#highlights","title":"Highlights","text":"<ul> <li>Made by experts for experts</li> <li>Scan multiple files on multiple images in one place</li> <li>User-friendly analysis of sandbox logs</li> <li>Analyze files in the sandbox without leaving your favorite terminal</li> </ul>"},{"location":"#installation","title":"Installation","text":"pipxpypiNix <pre><code>pipx install sandbox-cli\n</code></pre> <pre><code>pip install sandbox-cli\n</code></pre> <pre><code>nix shell 'github:Security-Experts-Community/sandbox-cli'\n</code></pre> <p>We recommend installing the utility using <code>pipx</code>. It allows you to install packages in your isolated environments and not break the global venv.</p> <p>Next step, the Getting started section.</p>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to this project will be documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"changelog/#0238","title":"0.2.38","text":""},{"location":"changelog/#added","title":"Added","text":"<ul> <li>Correct handling of the timeout that occurred during scan and re-scan</li> </ul>"},{"location":"changelog/#0234","title":"0.2.34","text":""},{"location":"changelog/#added_1","title":"Added","text":"<ul> <li>Options for downloading all tasks from the sandbox (requires a key with a special permission and support for the new API)</li> </ul>"},{"location":"changelog/#0233","title":"0.2.33","text":""},{"location":"changelog/#added_2","title":"Added","text":"<ul> <li>Option for managing the timeout when creating a task on re-scan</li> </ul>"},{"location":"changelog/#0232","title":"0.2.32","text":""},{"location":"changelog/#added_3","title":"Added","text":"<ul> <li>Add option to specifying outbound connections when scanning</li> </ul>"},{"location":"changelog/#0231","title":"0.2.31","text":""},{"location":"changelog/#added_4","title":"Added","text":"<ul> <li>Add option to specify custom browser in config #9</li> </ul>"},{"location":"changelog/#0230","title":"0.2.30","text":""},{"location":"changelog/#added_5","title":"Added","text":"<ul> <li>Add new command <code>browser</code> to open old reports in browser #8</li> <li>Add option to automatically open analysis link in browser #7</li> </ul>"},{"location":"changelog/#fixed","title":"Fixed","text":"<ul> <li>Default python module <code>webbrowser</code> doesn't work correctly by default in some systems (e.g. MacOS) #9</li> <li>Fix rewriting files with the same name when downloading artifacts #6</li> <li>Fix encoding issues when unpacking logs #5</li> </ul>"},{"location":"changelog/#0229","title":"0.2.29","text":""},{"location":"changelog/#fixed_1","title":"Fixed","text":"<ul> <li>Fixed bug in path resolving</li> </ul>"},{"location":"changelog/#0228","title":"0.2.28","text":""},{"location":"changelog/#added_6","title":"Added","text":"<ul> <li>Installing the package using <code>Nix</code> and documentation #4</li> </ul>"},{"location":"changelog/#0227","title":"0.2.27","text":""},{"location":"changelog/#added_7","title":"Added","text":"<ul> <li>Specifying the base path to the rules using the config #2</li> </ul>"},{"location":"changelog/#fixed_2","title":"Fixed","text":"<ul> <li>Problem with spaces in paths when saving files #3</li> </ul>"},{"location":"changelog/#0226","title":"0.2.26","text":""},{"location":"changelog/#added_8","title":"Added","text":"<ul> <li>Project documentation in <code>mkdocs</code> format</li> <li>Project logos</li> </ul>"},{"location":"changelog/#changed","title":"Changed","text":"<ul> <li>Rename <code>compiler</code> option to <code>rules</code></li> <li>Refactoring of the internal code base before the public release</li> </ul>"},{"location":"changelog/#0225","title":"0.2.25","text":""},{"location":"changelog/#added_9","title":"Added","text":"<p>Internal development</p>"},{"location":"configuration/","title":"Configuration","text":"<p>The utility is configured via a <code>toml</code> file.</p> <p>Note</p> <p>If no sandbox is specified, the functions related to interacting with the sandbox will be unavailable.</p>"},{"location":"configuration/#location","title":"Location","text":"Linux / MacOSWindows <pre><code>~/.config/sandbox-cli/config.toml\nor\n$XDG_CONFIG_HOME/sandbox-cli/config.toml\n</code></pre> <pre><code>%APPDATA%\\sandbox-cli\\config.toml\n</code></pre>"},{"location":"configuration/#config","title":"Config","text":""},{"location":"configuration/#passwords","title":"<code>passwords</code>","text":"<p>There is often a need to scan various password-protected zip archives.</p> <p>Here you can specify a list of frequently used passwords that the <code>sandbox-cli</code> will send to the sandbox for automatic unpacking.</p> <p>Default: <code>[\"infected\"]</code></p>"},{"location":"configuration/#sandbox","title":"<code>sandbox</code>","text":"Option Description Default name* Custom token name to be used in the parameters when selecting sandboxes. <code>None</code> key * A token received through the sandbox interface.  See how to get it in Getting started. <code>None</code> host * The IP address or domain where the sandbox is located.  Example: <code>10.10.10.10</code> or <code>sandbox.example.com</code> <code>None</code> max-workers The number of simultaneously running jobs. <code>8</code> <p>Note</p> <p>If you specify a higher number of <code>max-workers</code>, the performance will not increase, the tasks will just hang in the queue.</p>"},{"location":"configuration/#ssh","title":"<code>ssh</code>","text":"Option Description Default login The user's login on the server <code>None</code> password The user's password on the server <code>None</code>"},{"location":"configuration/#browser","title":"<code>browser</code>","text":"<p>Here you can specify custom browser to use for opening the analysis links.</p> Option Description Default path Path to custom browser <code>None</code> args Args to start the browser with <code>None</code> <p>Note</p> <p>Every argument must be in separate string.</p>"},{"location":"configuration/#full-configuration","title":"Full configuration","text":"Config example<pre><code># passwords that will be sent to the sandbox for unpacking archives\npasswords = [\"infected\"]\n\n# Use this section only if you don't want to use your default browser\n# or it works incorrectly\n# [browser]\n# path to your browser\n# path = \"C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe\"\n# args to run your browser with\n# args = [\"-new-tab\"]\n\n# Specify available sandboxes\n# Keep in mind that first sandbox is used by default\n# name - short name for the sandbox\n# key - token used for the sandbox\n# host - host of the sandbox\n# max-workers - simultaneously running scans\n# ssh username/password - optional params\n[[sandbox]]\nname = \"\"\nkey = \"\"\nhost = \"\"\nmax-workers = 8\nssh = { username = \"\", password = \"\" }\n\n[[sandbox]]\nname = \"\"\nkey = \"\"\nhost = \"\"\nmax-workers = 8\n</code></pre>"},{"location":"installing/","title":"Install sandbox-cli","text":"<p><code>sandbox-cli</code> is availabe as sandbox-cli on PyPi.</p> <p>Can be installed with <code>pipx</code> (recommeded) or <code>pip</code>:</p> <pre><code># with pipx\npipx install sandbox-cli\n\n# with pip\npip install sandbox-cli\n</code></pre> <p>Also available as <code>Nix</code> package with configuration customization:</p> <p>First, add repo to flake inputs:</p> flake.nix<pre><code>{\n  inputs = {\n    sandbox-cli = {\n      url = \"github:Security-Experts-Community/sandbox-cli\";\n    };\n  };\n}\n</code></pre> <p>Second, write the config for your home-manager configuration (<code>programs.sandbox-cli.settings</code> is 1-1 mapping of the configuration)</p> module.nix<pre><code>{ inputs, lib, pkgs, ... }:\n{\n  imports = [\n    inputs.sandbox-cli.homeManagerModules.default\n  ];\n\n  programs.sandbox-cli = {\n    enable = true;\n\n    settings = {\n      sandbox = [\n        {\n          name = \"sample-key-name\";\n          key = \"sample-key\";\n          host = \"127.0.0.1\";\n          max-workers = 1;\n        }\n      ];\n    };\n  };\n}\n</code></pre> <p>Alternatively you can install the only <code>sandbox-cli</code> app to your environment and write config by hand:</p> <pre><code>{\n    home.packages = [ inputs.sandbox-cli.packages.${pkgs.system}.sandbox-cli ];\n}\n</code></pre> <p>Alternatively you can use overlay from <code>inputs.sandbox-cli.overlays.default</code></p>"},{"location":"tutorial/download/","title":"Download files","text":"<p>Info</p> <p>For this option, you need to specify at least one sandbox in the config.</p> <p>It is often necessary to download some information from the task.</p> <p>If you don't want to poke all the buttons in the interface, you can simply run one of the following commands:</p> # Download all available data by task idsandbox-cli download --all b2ece7fa-b3db-4ed5-86c7-2bba4b55f563# Download only sandbox logs and automatically convertsandbox-cli download --logs --unpack b2ece7fa-b3db-4ed5-86c7-2bba4b55f563# Or you can just provide a link to the tasksandbox-cli download --all https://sandbox.example.com/tasks/b2ece7fa-b3db-4ed5-86c7-2bba4b55f563# You can also download multiple tasks in one requestsandbox-cli download --all b2ece7fa-b3db-4ed5-86c7-2bba4b55f563 https://sandbox.example.com/tasks/c7d567f0-5805-4191-a0f1-e35158dc4e80 <p>The structure of the 'downloads` directory.</p> tree<pre><code>downloads/\n\u251c\u2500\u2500 b2ece7fa-b3db-4ed5-86c7-2bba4b55f563\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 artifacts/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 debug/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 drakvuf-trace.log.zst\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-correlated.log.gz\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-normalized.log.gz\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 process_dump/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tcpdump.pcap\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 video.mp4\n\u2514\u2500\u2500 c7d567f0-5805-4191-a0f1-e35158dc4e80\n    \u251c\u2500\u2500 debug/\n    \u251c\u2500\u2500 drakvuf-trace.log.zst\n    \u251c\u2500\u2500 events-correlated.log.gz\n    \u251c\u2500\u2500 events-normalized.log.gz\n    \u251c\u2500\u2500 tcpdump.pcap\n    \u2514\u2500\u2500 video.mp4\n</code></pre> <p>Tip</p> <p>If you provide a full link to the sandbox, you do not need to specify the key name for this sandbox.</p> <pre><code>sandbox-cli download --all https://sandbox-1.example.com/tasks/... https://sandbox-2.example.com/tasks/...\n</code></pre> <p>For example, if the keys are named <code>sandbox-1</code> and <code>sandbox-2</code>. The key <code>sandbox-1</code> will be used to download the first task, and <code>sandbox-2</code> for the second.</p>"},{"location":"tutorial/download/#help","title":"Help","text":"sandbox-cli download --helpUsage: sandbox-cli download [ARGS] [OPTIONS]Download any artifact from the sandbox.\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 *  TASKS_ID  Links to tasks or task ids [required]                         \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Download options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --all         -a  Download all artifacts [default: False]                  \u2502\u2502 --debug       -d  Download debug artifacts [default: False]                \u2502\u2502 --artifacts   -A  Download artifacts [default: False]                      \u2502\u2502 --files       -f  Download files [default: False]                          \u2502\u2502 --crashdumps  -c  Download crashdumps (maybe be more 1GB) [default: False] \u2502\u2502 --procdumps   -p  Download procdumps [default: False]                      \u2502\u2502 --video       -v  Download video [default: False]                          \u2502\u2502 --logs        -l  Download logs [default: False]                           \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Parameters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --out         -o  Output directory [default: downloads]                    \u2502\u2502 --decompress  -D  Decompress downloaded files [default: False]             \u2502\u2502 --unpack      -U  Unpack downloaded files [default: False]                 \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Sandbox \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --key  -k  The key to access the sandbox test-1,test-2 [default: test-1]   |\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f"},{"location":"tutorial/email/","title":"Analyze emails","text":"<p>Info</p> <p>For this option, you need to specify at least one sandbox in the config.</p> <p>To get the email headers, specify the <code>eml</code> file in the parameters.</p> sandbox-cli email file.eml <p>The files will be downloaded to the <code>downloads</code> directory with the <code>headers</code> suffix.</p> tree<pre><code>downloads/\n\u2514\u2500\u2500 file.eml.headers\n</code></pre> <p>Usage example</p> <p>It is useful when it is necessary to decode or extract the headers of an email without the content itself.</p>"},{"location":"tutorial/email/#help","title":"Help","text":"sandbox-cli email --helpUsage: sandbox-cli email [ARGS] [OPTIONS]Send an email and get its headers\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 *  EMAILS  The path to the email files [required]           \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Parameters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --out  -o  Output directory [default: downloads]            \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Sandbox \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --key  -k  The key to access the sandbox                    \u2502\u2502            test-1,test-2,test-3 [default: test-1]           \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f"},{"location":"tutorial/getting-started/","title":"Getting started","text":""},{"location":"tutorial/getting-started/#get-public-api-token","title":"Get Public API token","text":"<p>Info</p> <p>If you do not have direct access to the sandbox interface, it is better to request access through your supervisor.</p> <ul> <li>Open the Access Tokens tab in the interface.</li> </ul> <p></p> <ul> <li>Click on <code>Create access token</code> and fill in the parameters using the example from the screenshot.</li> </ul> <p></p> <ul> <li>Now you can copy this token and save it to a config file.</li> </ul> <p></p>"},{"location":"tutorial/getting-started/#create-config-file","title":"Create config file","text":"<p>The details are described in Configuration</p>"},{"location":"tutorial/getting-started/#help","title":"Help","text":"sandbox-cli --helpUsage: sandbox-cli COMMANDWork with sandbox like a pro\u256d\u2500 Commands \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 conv unpack  Convert sandbox logs into an analysis-friendly format.       \u2502\u2502 download     Download any artifact from the sandbox.                      \u2502\u2502 email        Send an email and get its headers                            \u2502\u2502 images       Get available images in the sandbox.                         \u2502\u2502 report       Generate short report from sandbox scans.                    \u2502\u2502 rules        Working with raw sandbox rules                               \u2502\u2502 scanner      Scan with the sandbox.                                       \u2502\u2502 --help -h    Display this message and exit.                               \u2502\u2502 --version    Display application version.                                 \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f <p>Tip</p> <p>It looks much better in the terminal </p>"},{"location":"tutorial/images/","title":"Images","text":"<p>After receiving the token, you can verify its working by running <code>sandbox-cli images</code>.</p> <p>The command will display a list of available images in the sandbox.</p> sandbox-cli images\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\u2503 Name                 \u2503 ID                  \u2503 Version    \u2503 Product version \u2503\u2521\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2547\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2529\u2502 astra                \u2502 astralinux-orel-x64 \u2502    ...     \u2502       ...       \u2502\u2502 ubuntu               \u2502 ubuntu-jammy-x64    \u2502    ...     \u2502       ...       \u2502\u2502 Windows 10 Pro       \u2502 win10-1803-x64      \u2502    ...     \u2502       ...       \u2502\u2502 Windows 7 Enterprise \u2502 win7-sp1-x64        \u2502    ...     \u2502       ...       \u2502\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 <p>Info</p> <p>The image list may differ from the one shown.</p> <p>It all depends on the selected images in the license.</p> <p>When running with the <code>-h</code> flag, you can view the list of available options, in particular the sandboxes specified in the config file.</p> sandbox-cli images -hUsage: sandbox-cli images [OPTIONS]Get available images in the sandbox.\u256d\u2500 Sandbox \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --key  -k  The key to access the sandbox                                  \u2502\u2502            test-1,test-2,test-3 [default: test-1]                         \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f"},{"location":"tutorial/logs/","title":"Analyzing logs","text":""},{"location":"tutorial/logs/#structure","title":"Structure","text":"<p>After the behavioral analysis, you can download the analysis results which include:</p> <ul> <li><code>events-correlated.log.gz</code> - verdicts. In this case, <code>Trojan.Win32.Generic.a</code>;</li> <li><code>tcpdump.pcap</code> - a file with network events in <code>pcap</code> format;</li> <li><code>events-normalized.log.gz</code> - enriched events received from the analysis system;</li> <li><code>drakvuf-trace.log.zst</code> - raw data from the analysis system;</li> </ul> <p></p>"},{"location":"tutorial/logs/#how-to-analyze","title":"How to analyze","text":"<p>Just call the <code>conv</code> (or <code>unpack</code>) option and specify the file with the downloaded logs. In this case, <code>sandbox_logs.zip</code>:</p> sandbox-cli conv sandbox_logs.zip[INFO] Unpacking sandbox_logs.zip <p>The <code>sandbox-cli</code> unpacks logs into a convenient format, decomposes events by plugins, structures output, etc.</p> tree<pre><code>sandbox_logs\n\u251c\u2500\u2500 correlated\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-correlated.log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-correlated.log.malware\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 events-correlated.log.suspicious.Read.File.Data.DLLHijackMapSystem\n\u251c\u2500\u2500 drakvuf-trace\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 drakvuf-trace.log\n\u251c\u2500\u2500 network\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tcpdump.pcap\n\u251c\u2500\u2500 normalized\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-normalized.log\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-normalized.log.apimon\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events-normalized.log.cpuidmon\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 events-normalized.log.syscall\n\u2514\u2500\u2500 raw\n    \u251c\u2500\u2500 drakvuf-trace.log.zst\n    \u251c\u2500\u2500 events-correlated.log.gz\n    \u251c\u2500\u2500 events-normalized.log.gz\n    \u2514\u2500\u2500 tcpdump.pcap\n</code></pre> <p>Note</p> <p>The output is greatly reduced because a lot of information is collected under Windows</p> <p>Now you can easily find a suspicious event and analyze it.</p> event<pre><code>{\n  \"object.path\": \"users\\\\jamie\\\\desktop\\\\malware.dll\",\n  \"process.id\": \"2828\",\n  \"process.name\": \"users\\\\jamie\\\\desktop\\\\malware.exe\",\n  \"weight\": 10,\n  \"unixtime\": \"1741811223.840229\",\n  \"detect.name\": \"Read.File.Data.DLLHijackMapSystem\",\n  \"detect.type\": \"suspicious\",\n  \"mitre.tid\": \"T1574\"\n}\n</code></pre> <p>Tip</p> <p>You can specify not only one file, but also several in a row if you need to parse several logs.</p> <pre><code>sandbox-cli conv sandbox_logs.zip sandbox_logs_1.zip sandbox_logs_2.zip\n</code></pre>"},{"location":"tutorial/logs/#help","title":"Help","text":"sandbox-cli conv --helpUsage: sandbox-cli conv [ARGS]Convert sandbox logs into an analysis-friendly format.Output file structure: \u2022 drakvuf-trace    \u2022 drakvuf-trace.log \u2022 correlated    \u2022 events-correlated.log    \u2022 events-correlated.log.&lt;DETECT_NAME&gt; \u2022 normalized    \u2022 events-normalized.log    \u2022 events-normalized.log.&lt;DETECT_NAME&gt; \u2022 network    \u2022 tcpdump.pcap \u2022 raw    \u2022 drakvuf-trace.log.zst    \u2022 tcpdump.pcapUsage examples: \u2022 Checks for drakvuf-trace.log.gz or drakvuf-trace.log.zst in the current directory: sandbox-cli unpack . \u2022 Extracts and processes logs into the sandbox_logs directory: sandbox-cli unpack sandbox_logs.zip \u2022 Handles multiple archives simultaneously: sandbox-cli unpack sandbox_logs.zip sandbox_logs_1.zip\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 *  TRACES  The path to the folder with the raw traces or with the sandbox-logs.zip [required]             \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f"},{"location":"tutorial/report/","title":"View report","text":"<p>After scanning, you need to quickly understand what the sandbox was able to detect and what was not.</p> <p>To do this, you can generate a short report in the terminal by transferring the directory where the scan data was saved.</p> sandbox-cli report sandbox/ <p>By default, the report will be printed to the terminal as a table.</p> A glance at the generated output in <code>md</code> format Sample Image Verdict Static Memory Network malware.elf ubuntu-jammy-x64 Trojan-Downloader.Linux.Generic.n ptesc: crime_linux_ZZ_Diicot__Backdoor__NetworkScannerptesc: crime_linux_ZZ_Diicot__Backdoor__Updaterptesc: tool_linux_ZZ_UPX__RiskToolptesc: tool_linux_ZZ_UPX__Trojan__PatchedUPX ET HUNTING curl User-Agent to Dotted QuadSUSPICIOUS [PTsecurity] GET request in TCPWORM [PTsecurity] Trojan.Worm error message (APT Diicot) <p>Tip</p> <p>You can specify multiple folders with reports, they will be combined into one and displayed on the screen.</p> <pre><code>sandbox-cli report sandbox-1/ sandbox-2/\n</code></pre>"},{"location":"tutorial/report/#help","title":"Help","text":"sandbox-cli report --helpUsage: sandbox-cli report [ARGS] [OPTIONS]Generate short report from sandbox scans.\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 *  SRC  Folder(s) with sandbox reports (recursive search will be used) [required] \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Parameters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --mode    -m  Report output format [choices: cli, md] [default: cli]              \u2502\u2502 --latest  -l  Reports created in the last 2 hours [default: False]                \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f"},{"location":"tutorial/scans/rescan/","title":"Rescan","text":"<p>Info</p> <p>For this option, you need to specify at least one sandbox in the config.</p>"},{"location":"tutorial/scans/rescan/#quick-start","title":"Quick start","text":"sandbox-cli scanner re-scan sandbox_logs.zip[INFO] Using key: name=test-1 max_workers=8[DONE] sandbox_logs.zip \u2022 https://sandbox.example.com/tasks/56ae494b-fffc-11ef-a24b-72ab1bd29c47"},{"location":"tutorial/scans/rescan/#options","title":"Options","text":""},{"location":"tutorial/scans/rescan/#download-options","title":"Download options","text":"Option Description Default <code>--debug / -d</code> All debug files will be downloaded. <code>False</code>"},{"location":"tutorial/scans/rescan/#parameters","title":"Parameters","text":"Option Description Default <code>--rules / -r</code> The path to your own rules. <code>None</code> <code>--out / -o</code> The path where the analysis results will be saved. <code>./sandbox</code> <code>--local / -l</code> Compile rules locally or on the server.  I guess you can just ignore this option. <code>False</code> <code>--unpack / -U</code> The downloaded logs will be automatically converted.  Learn more in Analyzing logs. <code>False</code>"},{"location":"tutorial/scans/rescan/#sandbox-options","title":"Sandbox Options","text":"Option Description Default <code>--key / -k</code> The name of the key for accessing a specific sandbox. <code>None</code>"},{"location":"tutorial/scans/rescan/#cookbook","title":"Cookbook","text":""},{"location":"tutorial/scans/rescan/#rescan-multiple-files","title":"Rescan multiple files","text":"sandbox-cli scanner re-scan sandbox_logs.zip sandbox_logs_1.zip sandbox_logs_2.zip"},{"location":"tutorial/scans/rescan/#rescan-with-automatic-unpacking","title":"Rescan with automatic unpacking","text":"sandbox-cli scanner re-scan -U sandbox_logs.zip sandbox_logs_1.zip sandbox_logs_2.zip"},{"location":"tutorial/scans/rescan/#rescan-and-view-results","title":"Rescan and view results","text":"sandbox-cli scanner re-scan -U sandbox_logs.zip sandbox_logs_1.zip sandbox_logs_2.zipsandbox-cli report sandbox/"},{"location":"tutorial/scans/rescan/#help","title":"Help","text":"sandbox-cli scanner re-scan --helpUsage: sandbox-cli scanner re-scan [ARGS] [OPTIONS]Send traces to re-scan.\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 *  TRACES  Path to folder with drakvuf-trace.log.zst and tcpdump.pcap or sandbox_logs.zip [required] \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Download options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --debug  -d  Download debug artifacts [default: False]                                               \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Parameters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --rules   -r  The path to the folder with the rules or the default rules from the sandbox            \u2502\u2502 --out     -o  The path where to save the results [default: sandbox]                                  \u2502\u2502 --local   -l  The rules will be compiled locally using Docker (unix only) [default: False]           \u2502\u2502 --unpack  -U  Unpack downloaded files [default: False]                                               \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Sandbox Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --key  -k  The key to access the sandbox test-1,test-2,test-3 [default: test-1]                      \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f"},{"location":"tutorial/scans/scan-new/","title":"Advanced scan","text":"<p>Info</p> <p>For this option, you need to specify at least one sandbox in the config.</p>"},{"location":"tutorial/scans/scan-new/#quick-start","title":"Quick start","text":"# \"-t\" is the time of behavioral analysissandbox-cli scanner scan-new -t 120 malware[INFO] Using key: name=escdev max_workers=8[DONE] [win10-22H2-x64] \u2022 malware \u2022 https://sandbox.example.com/tasks/eafc5f87-ffac-11ef-96ad-72ab1bd29c47 <p>Note</p> <p>At startup, a progress bar will be launched with waiting, but this is not shown here.</p>"},{"location":"tutorial/scans/scan-new/#options","title":"Options","text":""},{"location":"tutorial/scans/scan-new/#download-options","title":"Download options","text":"<p>The options allow you to additionally configure which files will be downloaded from the task.</p> Option Description Default <code>--all / -a</code> Enables all of the following options. <code>False</code> <code>--debug / -d</code> All debug files will be downloaded. <code>False</code> <code>--artifacts / -A</code> All created artifacts (files and process dumps) will be downloaded.  Combines <code>-f</code> and <code>-p</code>. <code>False</code> <code>--files / -f</code> All files extracted during the analysis will be downloaded. <code>False</code> <code>--crashdumps / -c</code> A special file that is created during the BSOD.  By default, this file is not generated by the sandbox. <code>False</code> <code>--procdumps / -p</code> All process dumps during the analysis will be downloaded. <code>False</code>"},{"location":"tutorial/scans/scan-new/#parameters","title":"Parameters","text":"Option Description Default <code>--rules / -r</code> The path to your own rules. <code>None</code> <code>--out / -o</code> The path where the analysis results will be saved. <code>./sandbox</code> <code>--local / -l</code> Compile rules locally or on the server.  I guess you can just ignore this option. <code>False</code> <code>--upload-timeout / -T</code> This option allows you to increase the file upload timeout.  For example, if you are uploading a large file with a slow internet . <code>300</code> in seconds <code>--unpack / -U</code> The downloaded logs will be automatically converted.  Learn more in Analyzing logs. <code>False</code> <code>--decompress / -D</code> Since process dumps are downloaded in a compressed format, this option allows them to be decompressed automatically. <code>False</code>"},{"location":"tutorial/scans/scan-new/#sandbox-options","title":"Sandbox Options","text":"Option Description Default <code>--image / -i</code> The image on which the behavioral analysis will be performed. <code>None</code> <code>--key / -k</code> The name of the key for accessing a specific sandbox. <code>None</code> <code>--name / -n</code> The name of the file that will be in the sandbox. <code>{filename}</code> <code>--timeout / -t</code> Analysis duration. <code>300</code> in seconds <code>--syscall-hooks / -s</code> Read more about it in py-ptsandbox. <code>None</code> <code>--dll-hooks-dir / -dll</code> Read more about it in py-ptsandbox. <code>None</code> <code>--cmd</code> Read more about it in py-ptsandbox. <code>None</code> <code>--priority / -pr</code> Read more about it in py-ptsandbox. <code>3</code> <code>--procdump-new-processes-on-finish / -P</code> Read more about it in py-ptsandbox. <code>False</code> <code>--bootkitmon / -b</code> Read more about it in py-ptsandbox. <code>False</code> <code>--bootkitmon-duration / -bd</code> Read more about it in py-ptsandbox. <code>60</code> <code>--mitm-disabled / -M</code> Read more about it in py-ptsandbox. <code>False</code> <code>--disable-clicker / -dc</code> Read more about it in py-ptsandbox. <code>False</code> <code>--skip-sample-run / -S</code> Read more about it in py-ptsandbox. <code>False</code> <code>--vnc-mode / -V</code> Read more about it in py-ptsandbox. <code>disabled</code> <code>--extra-files / -e</code> Read more about it in py-ptsandbox. <code>None</code> <code>--outbound-connections / -oc</code> Whitelist of IP addresses to which connections from a VM are allowed (backconnect) <code>None</code> <p>Tip</p> <p>You can specify several images, for example:</p> <pre><code>sandbox-cli scanner scan-new -i win10-1803-x64 -i win11-23H2-x64\n</code></pre> <p>Tip</p> <p>You can specify several extra files, for example:</p> <pre><code>sandbox-cli scanner scan-new -e file1 -e file2 -e file3 ...\n</code></pre>"},{"location":"tutorial/scans/scan-new/#cookbook","title":"Cookbook","text":""},{"location":"tutorial/scans/scan-new/#starting-a-manual-analysis","title":"Starting a manual analysis","text":"# -V full - a task will be created in a special mode with support for manual analysis# -dc - disabling the clicker to control the mouse yourself# -i - selecting a scan image# -t 300 - behavioral analysis time (5 min)sandbox-cli scanner scan-new -V full -dc -i ubuntu-jammy-x64 -t 300 malware.elf"},{"location":"tutorial/scans/scan-new/#scan-the-sample-on-all-available-windows-images","title":"Scan the sample on all available windows images","text":"<p>For example, there are only three Windows images available on the stand, and analysis will be launched on all of them.</p> sandbox-cli scanner scan-new -i windows -t 120 malware.elf[INFO] Using key: name=test-1 max_workers=8[INFO] Scanning on: win10-22H2-x64, win10-1803-x64, win11-23H2-x64... <p>Tip</p> <p>Change <code>-i windows</code> to <code>-i linux</code> if you need to scan on all available linux images.</p>"},{"location":"tutorial/scans/scan-new/#scanning-a-large-amount-of-samples-at-a-time","title":"Scanning a large amount of samples at a time","text":"# -U - automatic unpacking of logssandbox-cli scanner scan-new -U -i win11-23H2-x64 -t 120 samples/*.exe"},{"location":"tutorial/scans/scan-new/#help","title":"Help","text":"sandbox-cli scanner scan-new --helpUsage: sandbox-cli scanner scan-new [ARGS] [OPTIONS]Send files to scan with the sandbox (advanced scan).\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 *  FILES  Path to the files or folders to scan [required]                                                                       \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Download options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --all         -a  Download all artifacts [default: False]                                                                       \u2502\u2502 --debug       -d  Download debug artifacts [default: False]                                                                     \u2502\u2502 --artifacts   -A  Download artifacts [default: False]                                                                           \u2502\u2502 --files       -f  Download files [default: False]                                                                               \u2502\u2502 --crashdumps  -c  Download crashdumps (maybe be more 1GB) [default: False]                                                      \u2502\u2502 --procdumps   -p  Download procdumps [default: False]                                                                           \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Parameters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --rules           -r  The path to the folder with the rules or the default rules from the sandbox                               \u2502\u2502 --out             -o  The path where to save the results [default: sandbox]                                                     \u2502\u2502 --local           -l  The rules will be compiled locally using Docker (unix only) [default: False]                              \u2502\u2502 --upload-timeout  -T  Upload timeout in seconds (increase if upload big files) [default: 300]                                   \u2502\u2502 --unpack          -U  Unpack downloaded files [default: False]                                                                  \u2502\u2502 --decompress      -D  Decompress downloaded files [default: False]                                                              \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\u256d\u2500 Sandbox Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\u2502 --image                             -i    The name of the image to scan (don't mix different platforms)                         \u2502\u2502                                                                                                                                 \u2502\u2502                                            \u2022 altworkstation-10-x64                                                              \u2502\u2502                                            \u2022 astralinux-smolensk-x64                                                            \u2502\u2502                                            \u2022 redos-8-x64                                                                        \u2502\u2502                                            \u2022 redos-murom-x64                                                                    \u2502\u2502                                            \u2022 ubuntu-jammy-x64                                                                   \u2502\u2502                                            \u2022 win10-1803-x64                                                                     \u2502\u2502                                            \u2022 win10-22H2-x64                                                                     \u2502\u2502                                            \u2022 win11-23H2-x64                                                                     \u2502\u2502                                            \u2022 win7-sp1-x64                                                                       \u2502\u2502                                            \u2022 win7-sp1-x64-ics                                                                   \u2502\u2502                                            \u2022 win8.1-update1-x64                                                                 \u2502\u2502                                            \u2022 winserv2016-1198-x64                                                               \u2502\u2502                                            \u2022 winserv2019-1879-x64                                                               \u2502\u2502                                            \u2022 linux                                                                              \u2502\u2502                                            \u2022 windows                                                                            \u2502\u2502 --key                               -k    The key to access the sandbox test-1,test-2,test-3 [default: test-1]                  \u2502\u2502 --name                              -n    Fake name for the sandbox (if specified more than one file will be applied to all     \u2502\u2502                                           files)                                                                                \u2502\u2502 --timeout                           -t    Analysis duration in seconds [default: 300]                                           \u2502\u2502 --syscall-hooks                     -s    Path to files with syscall hooks (file with syscall names splitted by newline)        \u2502\u2502 --dll-hooks-dir                     -dll  Path to directory with dll hooks                                                      \u2502\u2502 --cmd                                     Command line for file execution rundll32.exe {file},#1                                \u2502\u2502 --priority                          -pr   Priority of the scan (1-4) [default: 3]                                               \u2502\u2502 --procdump-new-processes-on-finish  -P    Collect dumps for all created and not finished processes [default: False]             \u2502\u2502 --bootkitmon                        -b    Enable bootkitmon [default: False]                                                    \u2502\u2502 --bootkitmon-duration               -bd   Bootkitmon duration in seconds [default: 60]                                          \u2502\u2502 --mitm-disabled                     -M    Disable MITM [default: False]                                                         \u2502\u2502 --disable-clicker                   -dc   Disable clicker [default: False]                                                      \u2502\u2502 --skip-sample-run                   -S    Skip sample run [default: False]                                                      \u2502\u2502 --vnc-mode                          -V    VNC mode [choices: disabled, full, read-only] [default: disabled]                     \u2502\u2502 --extra-files                       -e    Extra files to upload                                                                 \u2502\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f <p>Info</p> <p>The utility has a fairly extensive list of images, but this doesn't mean that they are all available or will be available.</p> <p>But in general, if you are interested in some of the images, then I think you can find out more information from the manager.</p>"},{"location":"tutorial/scans/scan/","title":"Scan","text":"<p>Warning</p> <p>This is an outdated option and not supported as well as others, it is recommended to use Advanced scan.</p> <p>The documentation for the options can be viewed in the same section.</p> <p>It still remains because the old versions of the sandbox don't support the new API.</p>"},{"location":"tutorial/scans/scan/#quick-start","title":"Quick start","text":"sandbox-cli scanner scan -t 120 malware"}]}